<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja-JP">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="keywords" content="Simple Directmedia Layer SDL2.0">
<link rel="top"    href="../index.html" title="ホーム">
<link rel="parent" href="./index.html"  title="1つ上">
<title>SDL2.0 日本語リファレンス - 初期化と終了</title>
</head>
<body>
<h1>初期化と終了</h1>
インクルードファイル: SDL.h
<h2>概要</h2>
これらの関数はSDLの設定のために使われ, プログラム全体に影響がある.
<h3>初期化の概要</h3>
<p>
SDLを使うためには, 他のほとんどの関数の前にSDL_Init()を呼ぶ必要がある.
SDL_Init()の役割は, SDLライブラリを正常に初期化し, 要求に応じて個別のサブシステムを開始することである.
</p>
<p>
イベントハンドル, ファイルI/O, そしてスレッドサブシステムはデフォルトで初期化される.
他のサブシステムを使うときは個別に指定して初期化しなければならない.
論理和で複数のサブシステムを指定できる.<br>
</p>
<p>
例: <code>SDL_Init(SDL_INIT_VIDEO|SDL_INIT_AUDIO);</code><br>
デフォルトの3つに加え, ビデオとオーディオのサブシステムを初期化する.
</p>
<p>
いくつかのOSでは, SDL_Init()はSDL_main()が定義されていなければ失敗する.
あらかじめSDL_SetMainReady()を呼べば, この失敗を回避できる.
しかし, 不正な初期化はプログラムをクラッシュさせ, 調査を難しくするため, ユーザがSDL_SetMainReady()を呼ぶときは注意する必要がある.
</p>
<h3>終了の概要</h3>
<p>
デフォルトの3つを含むサブシステムを安全に終了させるために, SDLアプリケーションが終了する前にSDL_Quit()を呼ぶ必要がある.
</p>
<p>
SDL_Quit()を使う場合は, 自動的に全てのサブシステムを終了するため, 個別に指定する必要はない.
</p>
<h2>関数</h2>
<ol>
<li><a href="#SDL_Init">SDL_Init</a></li>
<li><a href="#SDL_InitSubSystem">SDL_InitSubSystem</a></li>
<li><a href="#SDL_Quit">SDL_Quit</a></li>
<li><a href="#SDL_QuitSubSystem">SDL_QuitSubSystem</a></li>
<li><a href="#SDL_SetMainReady">SDL_SetMainReady</a></li>
<li><a href="#SDL_WasInit">SDL_WasInit</a></li>
</ol>
<h2>SDL Wikiへのリンク</h2>
<a href="https://wiki.libsdl.org/CategoryInit">CategoryInit - SDL Wiki</a>
<hr>

<h2><a name="SDL_Init">SDL_Init</a></h2>
SDLライブラリを初期化する.
他のあらゆるSDLの関数を呼び出す前にこの関数を呼ぶ必要がある.
<h3>構文</h3>
<code>int SDL_Init(Uint32 flags)</code>
<h3>引数</h3>
<table border="1" summary="SDL_Init">
<tr><td>flags</td><td>サブシステム初期化フラグ</td></tr>
</table>
<h3>戻り値</h3>
成功のとき0, エラーのとき負の数のエラーコードを戻す.
そのときSDL_GetError()を呼んで詳細を知ることができる.
<h3>詳細</h3>
<p>
イベントハンドル, ファイルI/O, そしてスレッドサブシステムはデフォルトで初期化される.
他のサブシステムを使うときは指定して初期化しなければならない.
</p>
<p>
flagsは以下の項目の論理和で複数設定できる:
<table border="1" summary="SDL_Init flags">
<tr><td>SDL_INIT_TIMER</td><td>タイマ サブシステム</td></tr>
<tr><td>SDL_INIT_AUDIO</td><td>オーディオ サブシステム</td></tr>
<tr><td>SDL_INIT_VIDEO</td><td>ビデオ サブシステム</td></tr>
<tr><td>SDL_INIT_JOYSTICK</td><td>ジョイスティック サブシステム</td></tr>
<tr><td>SDL_INIT_HAPTIC</td><td>ハプティクス(感覚フィードバック) サブシステム</td></tr>
<tr><td>SDL_INIT_GAMECONTROLLER</td><td>コントローラー サブシステム</td></tr>
<tr><td>SDL_INIT_EVENTS</td><td>イベント サブシステム</td></tr>
<tr><td>SDL_INIT_EVERYTHING</td><td>上記のサブシステムの全て</td></tr>
<tr><td>SDL_INIT_NOPARACHUTE</td><td>fatal signalをキャッチしない</td></tr>
</table>
</p>
<p>
SDL_INIT_NOPARACHUTEを指定しない限り, (SIGSEGVのような)いくつかのfatal signalのためのクリーンアップシグナルハンドラが設定される.
</p>
<p>
個別にサブシステムを初期化したい場合は, SDL_Init(0)を呼び, 後で必要なflagsを指定してSDL_InitSubSystem()を呼ぶとよい.
</p>
<h3>関連項目(関数)</h3>
<a href="#SDL_InitSubSystem">SDL_InitSubSystem</a><br>
<a href="#SDL_Quit">SDL_Quit</a><br>
<a href="#SDL_WasInit">SDL_WasInit</a><br>
<a href="#SDL_SetMainReady">SDL_SetMainReady</a><br>
<h3>SDL Wikiへのリンク</h3>
<a href="https://wiki.libsdl.org/SDL_Init">SDL_Init - SDL Wiki</a><br>
<hr>

<h2><a name="SDL_InitSubSystem">SDL_InitSubSystem</a></h2>
サブシステムを個別に初期化する.
<h3>構文</h3>
<code>int SDL_InitSubSystem(Uint32 flags)</code>
<h3>引数</h3>
<table border="1" summary="">
<tr><td>flags</td><td>SDL_Init()と同じ.</td></tr>
</table>
<h3>戻り値</h3>
成功のとき0, エラーのとき負の数のエラーコードを戻す.
そのときSDL_GetError()を呼んで詳細を知ることができる.
<h3>詳細</h3>
<p>
SDL_Init()で初期化した後でもSDL_InitSubSystem()で未初期化のサブシステムを初期化することができる.
</p>
<p>
SDL_Init()はアサーションとクラッシュプロテクションを初期化し, その後SDL_InitSubSystem()を呼んでいる.
それらのプロテクションを回避したい場合は直接SDL_InitSubSystem()を呼ぶとよい.
</p>
<h3>関連項目(関数)</h3>
<a href="#SDL_Init">SDL_Init</a><br>
<a href="#SDL_Quit">SDL_Quit</a><br>
<a href="#SDL_QuitSubSystem">SDL_QuitSubSystem</a><br>
<h3>SDL Wikiへのリンク</h3>
<a href="https://wiki.libsdl.org/SDL_InitSubSystem">SDL_InitSubSystem - SDL Wiki</a><br>
<hr>

<h2><a name="SDL_Quit">SDL_Quit</a></h2>
サブシステムを終了する. いかなる場合でもこの関数を呼ばなければならない.
<h3>構文</h3>
<code>void SDL_Quit(void)</code>
<h3>詳細</h3>
<p>
SDL_QuitSubSystem()で既に個別にサブシステムを終了した場合でもこの関数を呼ばなければならない.
</p>
<p>
SDL_Init()やSDL_InitSubSystem()の代わりにSDL_VideoInit()等のサブシステム初期化関数を呼んでサブシステムを開始した場合は, SDL_Quit()を呼ぶ前にSDL_VideoQuit()等のサブシステム終了関数を呼ぶ必要がある.
</p>
<p>
この関数はatexit()でアプリケーションが終了するときに必ず呼ばれるようにすることができる.
しかしライブラリや他の動的に読み込まれるコードでそのようにするのはよい方法ではない.
</p>
<h3>関連項目(関数)</h3>
<a href="#SDL_Init">SDL_Init</a><br>
<a href="#SDL_QuitSubSystem">SDL_QuitSubSystem</a><br>
<h3>SDL Wikiへのリンク</h3>
<a href="https://wiki.libsdl.org/SDL_Quit">SDL_Quit - SDL Wiki</a>
<hr>

<h2><a name="SDL_QuitSubSystem">SDL_QuitSubSystem</a></h2>
サブシステムを個別に終了する.
<h3>構文</h3>
<code>void SDL_QuitSubSystem(Uint32 flags)</code>
<h3>引数</h3>
<table border="1" summary="">
<tr><td>flags</td><td>SDL_Init()と同じ</td></tr>
</table>
<h3>詳細</h3>
<p>
SDL_Init()やSDL_InitSubSystem()の代わりにSDL_VideoInit()等のサブシステム初期化関数を読んでサブシステムを開始した場合, SDL_QuitSubSystem()とSDL_WasInit()は使えない.
その場合はSDL_VideoQuit()等のサブシステム終了関数を直接呼ぶ必要がある.
</p>
<p>
全てのサブシステムをSDL_QuitSubSystem()で終了した場合でもSDL_Quit()を呼ぶ必要がある.
</p>
<h3>関連項目(関数)</h3>
<a href="#SDL_InitSubSystem">SDL_InitSubSystem</a><br>
<a href="#SDL_Quit">SDL_Quit</a><br>
<h3>SDL Wikiへのリンク</h3>
<a href="https://wiki.libsdl.org/SDL_QuitSubSystem">SDL_QuitSubSystem - SDL Wiki</a>
<hr>

<h2><a name="SDL_SetMainReady">SDL_SetMainReady</a></h2>
SDL_Main()を使わないときSDL_Init()の失敗を回避する
<h3>構文</h3>
<code>void SDL_SetMainReady(void)</code>
<h3>詳細</h3>
<p>
この関数はSDL_main.hで定義されていて, プリプロセッサがmain()をSDL_main()で再定義するときに使用される.
main()関数を再定義されないようにするためには, SDL.hをインクルードする前にSDL_MAIN_HANDLEDを定義する必要がある
</p>
<h3>関連項目(関数)</h3>
<a href="#SDL_Init">SDL_Init</a><br>
<h3>SDL Wikiへのリンク</h3>
<a href="https://wiki.libsdl.org/SDL_SetMainReady">SDL_SetMainReady - SDL Wiki</a>
<hr>

<h2><a name="SDL_WasInit">SDL_WasInit</a></h2>
初期化された個別のサブシステムのマスクを戻す
<h3>構文</h3>
<code>Uint32 SDL_WasInit(Uint32 flags)</code>
<h3>引数</h3>
<table border="1" summary="">
<tr><td>flags</td><td>SDL_Init()と同じ</td></tr>
</table>
<h3>戻り値</h3>
<p>
flagsが0のとき全ての初期化されたサブシステムのマスクを戻す.
その他のとき個別のサブシステムの状態を戻す.
</p>
<p>
戻り値にはSDL_INIT_NOPARACHUTEは含まれない.
</p>
<h3>関連項目(関数)</h3>
<a href="#SDL_Init">SDL_Init</a><br>
<a href="#SDL_InitSubSystem">SDL_InitSubSystem</a><br>
<h3>SDL Wikiへのリンク</h3>
<a href="https://wiki.libsdl.org/SDL_WasInit">SDL_WasInit - SDL Wiki</a>
</body>
</html>
